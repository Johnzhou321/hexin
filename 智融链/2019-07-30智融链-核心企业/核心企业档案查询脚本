SELECT CODE FROM (SELECT t1.CODE,IF(FIND_IN_SET(PARENT_ID, @pids) > 0, @pids := CONCAT(@pids, ',', id), 0) AS ischild
FROM (SELECT ID,PARENT_ID,CODE FROM `CHAIN` AS t WHERE IS_DELETE = 0 AND SERVICE_TYPE = 1) t1,
(SELECT @pids := (SELECT GROUP_CONCAT(ID) FROM `CHAIN` WHERE CREATE_ENT_ID = 29 GROUP BY CREATE_ENT_ID)) t2
) t3 WHERE ischild != 0
